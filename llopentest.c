#include "linklayer.h"

int main(int argc, char *argv[]){
    
    if(argc < 3){
        printf("....\n");
        exit(1);
    }

    printf("%s %s\n", argv[1], argv[2]);
    fflush(stdout);

    if (strcmp(argv[2], "tx") == 0)
   	{
	
	    printf("tx mode\n");

		// open connection
		struct linkLayer ll;
		    sprintf(ll.serialPort, "%s", argv[1]);
		    ll.role = TRANSMITTER;
		    ll.baudRate = B9600;
		    ll.numTries = 5;
		    ll.timeOut = 3;

    	/*	if(llopen(ll)==-1) {
        		fprintf(stderr, "Could not initialize link layer connection\n");
        		exit(1);
        */
        if(llopen(ll) == -1)    printf("ERROR LLOPEN/TX MODE\n");
        else printf("SUCESS - LLOPEN/TX MODE\n");
   	}
    else if(strcmp(argv[2], "rx") == 0)
   	{
	
	    printf("rx mode\n");

		// open connection
		struct linkLayer ll;
		    sprintf(ll.serialPort, "%s", argv[1]);
		    ll.role = RECEIVER;
		    ll.baudRate = B9600;
		    ll.numTries = 5;
		    ll.timeOut = 3;

    	/*	if(llopen(ll)==-1) {
        		fprintf(stderr, "Could not initialize link layer connection\n");
        		exit(1);
        */
        if(llopen(ll) == -1)    printf("ERROR LLOPEN/RX MODE\n");
        else printf("SUCESS - LLOPEN/RX MODE\n");
   	}
    else printf("error on parameters\n\n");

    return 0;
}